version: 0.0.{build}
shallow_clone: true
clone_depth: 1
build:
  verbosity: minimal

environment:
    matrix:
        - PYTHON: "C:\\Python37"
          ARCH: "32"
        - PYTHON: "C:\\Python37-x64"
          ARCH: "64"

install:
    - "%PYTHON%\\python.exe --version"
    - "%PYTHON%\\Scripts\\pip install https://github.com/williballenthin/vivisect/zipball/master"
    - "%PYTHON%\\Scripts\\pip install pyinstaller"
    - ps: Set-Content "steamgamestattracker\\version.py" ( "__version__ = '{0}'" -f ( git describe --tags --always ) )
    - "%PYTHON%\\Scripts\\pip install -e ."
    - "%PYTHON%\\Scripts\\pyinstaller steamgamestattracker.spec"
    - "move dist\\*.exe dist\\steamgamestattracker%ARCH%.exe"

build: off

artifacts:
    - path: "dist\\steamgamestattracker.exe"
    - path: "dist\\steamgamestattracker%ARCH%.exe"
    - path: "dist\\steamgamestattracker32.exe"
    - path: "dist\\steamgamestattracker64.exe"